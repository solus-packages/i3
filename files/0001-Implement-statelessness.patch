From 7acdc203b8442b5f5df50b74839d6aaf386eeb0c Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@stroblindustries.com>
Date: Wed, 1 Mar 2017 23:00:32 +0200
Subject: [PATCH 1/1] Implement statelessness.

---
 Makefile.am             | 2 +-
 libi3/get_config_path.c | 8 +++++++-
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 0368ecca..8869bc05 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -30,7 +30,7 @@ dist_bin_SCRIPTS = \
 	i3-sensible-pager \
 	i3-sensible-terminal
 
-i3confdir = $(sysconfdir)/i3
+i3confdir = /usr/share/defaults/i3
 dist_i3conf_DATA = \
 	etc/config \
 	etc/config.keycodes
diff --git a/libi3/get_config_path.c b/libi3/get_config_path.c
index efece5cd..d5596ee1 100644
--- a/libi3/get_config_path.c
+++ b/libi3/get_config_path.c
@@ -69,7 +69,13 @@ char *get_config_path(const char *override_configpath, bool use_system_paths) {
     if (path_exists(config_path))
         return sstrdup(config_path);
 
-    /* 4: check for $XDG_CONFIG_DIRS/i3/config */
+    /* 4: check stateless directory */
+    config_path = "/usr/share/defaults/i3/config";
+    if (path_exists(config_path))
+        return config_path;
+    free(config_path);
+
+    /* 5: check for $XDG_CONFIG_DIRS/i3/config */
     if ((xdg_config_dirs = getenv("XDG_CONFIG_DIRS")) == NULL)
         xdg_config_dirs = SYSCONFDIR "/xdg";
 
-- 
2.12.0

